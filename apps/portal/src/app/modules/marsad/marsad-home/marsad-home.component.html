<div class="bg-[var(--color-nimicgreen)] white-text marsadTheme">
  <app-header></app-header>
  <section id="marsad-home-banner">
    <div class="container mx-auto px-1 py-8 text-center">
      <h1
        class="marsadTitle text-4xl md:text-8xl font-extrabold tracking-wide text-white font-lyon-arabic  mb-4" 
      >
        {{ 'MARSAD.TITLE' | translate }}
      </h1>

      <h2 class="marsadSubTitle text-white font-lyon-arabic mb-4">
        <ngx-typed-js [strings]="typingConfig.strings" [typeSpeed]="typingConfig.typeSpeed" [backSpeed]="typingConfig.backSpeed" [backDelay]="typingConfig.backDelay" [startDelay]="typingConfig.startDelay" [loop]="typingConfig.loop" [showCursor]="typingConfig.showCursor" [cursorChar]="typingConfig.cursorChar">
          <span class="typing"></span>
        </ngx-typed-js>
      </h2>

      <a
        [routerLink]="['/', currentLang, 'marsad', 'marsad-reports']"
        (click)="scrollToTop()"
        class="marsadLink inline-block min-w-[160px] border border-solid border-white text-white no-underline font-semibold px-6 py-3 shadow hover:bg-white hover:text-black transition"
      >
        {{ 'MARSAD.MORE' | translate }}
      </a>
    </div>
  </section>
  <section id="marsad-home-navigation" class="hidden md:block sticky top-0 z-10 shadow-md">
    <div class="container mx-auto px-1 py-2 relative">
      <button
        #prevBtn
        class="carousel-nav-btn prev-btn absolute left-0 top-1/2 -translate-y-1/2 bg-white/20 hover:bg-white/30 text-white p-2 rounded-full z-20"
        (click)="onPrevClick()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 19l-7-7 7-7"
          />
        </svg>
      </button>
      <div #carouselContainer class="carousel-container overflow-hidden">
        <ul
          #carouselList
          class="flex flex-nowrap gap-4 transition-transform duration-300 ease-in-out"
        >
          @for (data of marsadData | keyvalue; track data.key) {
          <li class="whitespace-nowrap">
            <a
              (click)="scrollToSection($event, data.key)"
              class="text-white hover:text-white transition-colors cursor-pointer"
            >
              @if (currentLang === 'ar') {
              {{ data.value[0].name }}
              } @else {
              {{ data.value[0].nameEn }}
              }
            </a>
          </li>
          }
        </ul>
      </div>
      <button
        #nextBtn
        class="carousel-nav-btn next-btn absolute right-0 top-1/2 -translate-y-1/2 bg-white/20 hover:bg-white/30 text-white p-2 rounded-full z-20"
        (click)="onNextClick()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"
          />
        </svg>
      </button>
    </div>
  </section>
  <div class="main-container">
    <main class="main-content" [@routeAnimations]>
      <div class="container mx-auto px-1 py-8">
        @for (data of marsadData | keyvalue; track data.key) {
        <section
          [id]="data.key"
          class="w-full mb-8 p-4 border border-[#2d3c3f] bg-[rgb(0_0_0_/_26%)]"
        >
          <div class="flex flex-col items-center justify-center gap-4">
            <div
              class="flex flex-col md:flex-row md:items-center md:justify-center md:gap-8 w-full"
            >
              <div class="w-full md:w-1/4 text-center">
                <h2 class="text-2xl font-bold text-white">
                  @if (currentLang === 'ar') {
                  {{ data.value[0].name }}
                  } @else {
                  {{ data.value[0].nameEn }}
                  }
                </h2>
                <div class="mb-4 md:mb-0 mt-2 text-white">
                  <p class="text-xl font-semibold">
                    @if (currentLang === 'ar') {
                    <span
                      style="font-size: 2.2rem"
                      [innerHTML]="data.value[0].summary"
                    ></span>
                    } @else {
                    <span
                      style="font-size: 2.2rem"
                      [innerHTML]="data.value[0].summaryEn"
                    ></span>
                    }
                  </p>
                  <p class="text-sm mt-1">
                    @if (currentLang === 'ar') {
                    {{ data.value[0].growth }}
                    } @else {
                    {{ data.value[0].growthEn }}
                    }
                  </p>
                </div>
              </div>
              <div
                class="content w-3/4 w-full md:w-3/4 relative"
                #chartContainer
                [style.background-color]="backgroundColor"
                style="width: 100%; min-height: 400px"
              >
                @if (data.value && data.value[0] && data.value[0].series && data.value[0].series.length > 0) {
                  <div class="chart-wrapper">
                    <ngx-charts-line-chart
                      [view]="view"
                      [scheme]="colorScheme"
                      [results]="data.value"
                      [gradient]="gradient"
                      [xAxis]="showXAxis"
                      [yAxis]="showYAxis"
                      [legend]="showLegend"
                      [showXAxisLabel]="showXAxisLabel"
                      [showYAxisLabel]="showYAxisLabel"
                      [xAxisLabel]="xAxisLabel"
                      [yAxisLabel]="yAxisLabel"
                      [timeline]="timeline"
                      [autoScale]="autoScale"
                      [roundDomains]="roundDomains"
                      [curve]="curve"
                      [rangeFillOpacity]="rangeFillOpacity"
                      [animations]="animations"
                      [tooltipDisabled]="tooltipDisabled"
                      [trimXAxisTicks]="trimXAxisTicks"
                      [trimYAxisTicks]="trimYAxisTicks"
                      [maxXAxisTickLength]="maxXAxisTickLength"
                      [maxYAxisTickLength]="maxYAxisTickLength"
                      [xAxisTickFormatting]="xAxisTickFormatting"
                      [yAxisTickFormatting]="yAxisTickFormatting"
                      class="chart"
                    >
                    </ngx-charts-line-chart>
                  </div>
                } @else {
                  <div class="flex items-center justify-center h-full">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white"></div>
                  </div>
                }
              </div>
            </div>
          </div>
        </section>
        }
      </div>
    </main>
  </div>
  <app-footer></app-footer>
</div>
